!function(){"use strict";angular.module("as.search",["list-autocomplete"])}(),function(){"use strict";function e(e,a){function t(t,n,r){return e.get("./templates/directives/search/searchMaster"+r.templatetype+".html").success(function(e){n.replaceWith(a(e)(t))}).error(function(e){alert("Sorry for the error, Please refresh this page")})}return{restrict:"AE",scope:{searchInitialData:"=",startSearchNow:"=",reportingFun:"=",options:"=?",closeModalFun:"=",messageNeeded:"@"},controller:"searchMasterController",link:t}}function a(e,a,t,n,r,i,o,s,c,d,l,h,u,p,m,f,g){function y(a){S(),ce.stream++,T(le),D(le),e.vResettingWaiting=!1,e.isFetchingSelected=!1;var t=a.data,n={};angular.isDefined(t)&&(e.totalCount=t.totalCount,n=1==t.checkboxes.success?t.checkboxes:{},de=t.network?t.network:[],1==t.people.success&&(e.resultProfiles=t.people.data,O(e.resultProfiles))),b(),angular.forEach(n.data,function(a,t){angular.isDefined(e.search_data.fields[t])&&(e.search_data.fields[t].vCheckboxes=a)}),R(le)}function _(){try{e.closeModalFun.close()}catch(e){}}function S(){ce.stream=1,e.resultDataAttributes.scrollMoreFlag=!1,e.resultProfiles=[]}function b(){e.search_data.fields=Object.keys(e.search_data.fields).reduce(function(a,t){var n=e.search_data.fields[t];return a[t]=n,n.vCheckboxes||!n.futherSearchParams||!n.futherSearchParams.dropdownList||n.singleSearch?a:(n.vCheckboxes=n.futherSearchParams.dropdownList.reduce(function(e,a,t){return t>5?e:(e[a[n.futherSearchParams.serviceIdField]]={count:0,id:a[n.futherSearchParams.serviceIdField],name:a[n.futherSearchParams.serviceNameField]},e)},{}),a)},{});for(var a in e.search_data.fields){var t=e.search_data.fields[a];if(("inputBox"===t.futherSearchType||t.singleSearch)&&angular.isDefined(le[a])&&"object"==typeof le[a]&&le[a].constructor===Array){for(var n=0;n<le[a].length;n++){t.displayName||(t.displayName=a);var r={name:t.displayName+": "+le[a][n],id:le[a][n]};if("dropdown"===t.futherSearchType){var i=!1;t.futherSearchParams&&angular.isArray(t.futherSearchParams.dropdownList)&&angular.forEach(t.futherSearchParams.dropdownList,function(e,r){i||e[t.futherSearchParams.serviceIdField]!=le[a][n]||(i=e[t.futherSearchParams.serviceNameField])}),r.name=i||le[a][n]}P(r,a,{justAdd:!0})}if("inputBox"===t.futherSearchType)e.search_data.fields[a].futherSearchParams.textSelected=le[a][0];else if(t.singleSearch&&t.futherSearchParams&&t.futherSearchParams.dropdownList)for(var o in t.futherSearchParams.dropdownList)if(t.futherSearchParams.dropdownList[o].id==le[a][0]){e.search_data.fields[a].futherSearchParams.fullSelected=t.futherSearchParams.dropdownList[o];break}}}}function v(a){var t=[];angular.forEach(e.search_data.categories,function(a){angular.forEach(a.fields,function(a,n){e.search_data.fields[a]||t.push(a)})});for(var n in e.search_data.categories)for(var r in t)-1!==e.search_data.categories[n].fields.indexOf(t[r])&&e.search_data.categories[n].fields.splice(e.search_data.categories[n].fields.indexOf(t[r]),1);console.log("$scope.search_data.categories",angular.copy(e.search_data.categories),t),angular.forEach(e.search_data.categories,function(t){angular.forEach(t.fields,function(t,n){angular.isDefined(e.search_data.dataParams)&&void 0!==e.search_data.dataParams[t]&&(le[t]=[],-1!==[String,Number].indexOf(e.search_data.dataParams[t].constructor)?le[t].push(e.search_data.dataParams[t]):le[t]=e.search_data.dataParams[t]),angular.isDefined(e.search_data.fields[t].preqFunctions)&&!a&&angular.forEach(e.search_data.fields[t].preqFunctions,function(e){e.fName(t,e)})})})}function k(a,t){function n(n){var r=n,i=!0;angular.isUndefined(t.expectedSchema)&&(t.expectedSchema=[]);for(var o in t.expectedSchema)angular.isDefined(r[t.expectedSchema[o]])?r=r[t.expectedSchema[o]]:i=!1;return t.removeIfNoData&&!i&&(delete e.search_data.fields[a],v(!0)),e.search_data.fields[a].futherSearchParams.dropdownList=r,r}return r.postDataCall(t.serviceLink,t.paramsToSend,n)}function w(a,t){P(a,t),e.search_data.fields[t].futherSearchParams.idSelected=-1,e.search_data.fields[t].futherSearchParams.textSelected=""}function x(e,a){P(e,a)}function C(a,t){var n=e.search_data.fields[t];n.displayName||(n.displayName=t);var a={name:n.displayName+": "+a,id:a};P(a,t)}function P(a,t,n){function r(){if(!angular.isUndefined(n)&&n.justAdd)return i;e.vBoxChanged(i.id,t)}var i={id:isScalar(a)?a:a[e.search_data.fields[t].futherSearchParams.serviceIdField],name:isScalar(a)?a:a[e.search_data.fields[t].futherSearchParams.serviceNameField],checked:!1!==(n&&n.checked),count:0};(angular.isUndefined(e.search_data.fields[t].vCheckboxes)||e.search_data.fields[t].singleSearch)&&(e.search_data.fields[t].vCheckboxes={}),e.search_data.fields[t].vCheckboxes[i.id]=i,e.search_data.fields[t].countsRequired?q(t,i.id,function(e){i.count=e.data,r()}):r()}function F(a,t,n){if(as_upgrade(10),e.search_data.fields[t].singleSearch&&(le[t]=[]),!0===e.search_data.fields[t].vCheckboxes[a].checked){if(angular.isUndefined(le[t])&&(le[t]=[]),-1==le[t].indexOf(a)){var r=!1;"string"==typeof a&&""==a&&(r=!0),r||le[t].push(a)}}else le[t].splice(le[t].indexOf(a),1),"inputBox"==e.search_data.fields[t].futherSearchType&&(e.search_data.fields[t].futherSearchParams.textSelected="");H(le)}function N(a,t){T(a)&&angular.forEach(e.search_data.fields,function(e,a){angular.forEach(e.vCheckboxes,function(e,a){e.checked=!1})})}function D(a){function t(t){e.isFetchingSelected=!1,1==t.success?(e.resultCount=t.data,I(e.resultCount,a)):t.data=0;try{e.reportingFun.filterCountSuccess({displayName:e.displayName,response:t,dataTosend:n,api:"./search/filterCount"})}catch(e){}}var n;void 0!=oe&&oe.resolve(),oe=i.defer(),n=angular.copy(a),n=Object.keys(n).reduce(function(a,t){if(e.search_data.fields[t]){var r=e.search_data.fields[t];if(r.dataPreProcessors&&r.dataPreProcessors.constructor==Array&&r.dataPreProcessors.length>0)for(var i=0;i<r.dataPreProcessors.length;i++)n=r.dataPreProcessors[i](n,n[t],t,r)}return a},n),n.other_params||(n.other_params={}),n.other_params.fetch_lost=!0,!1===e.search_data.fetchLost&&(n.other_params.fetch_lost=!1),e.search_data.authenticated_only&&(n.authenticated_only=!0),e.isFetchingSelected=!0;var o={timeout:oe.promise};return r.postDataConfigCall("./search/filterCount",n,o,t)}function I(e,a){function t(e){he.sNumber++}if(n.app_data.same_com_log&&(new Date).getTime()-he.sTime>8e3){var i={count:e[0].count,params:a,index:he.sNumber};return r.postDataCall("./search/track_searches",i,t)}}function L(){function a(a){e.isFetchingSelected=!1,e.vResettingWaiting&&(e.vResettingWaiting=!1),1==a.success?(e.resultDataAttributes.scrollMoreFlag=!1,O(a.data),e.resultProfiles=e.resultProfiles.concat(a.data),ce.stream++):e.resultDataAttributes.scrollMoreFlag=!0,-1==a.success&&-2==a.error&&(e.showLoginCard=!0),as_upgrade(100)}var t=angular.copy(le);void 0!=se&&se.resolve(),se=i.defer(),t=Object.keys(t).reduce(function(a,n){if(e.search_data.fields[n]){var r=e.search_data.fields[n];if(r.dataPreProcessors&&r.dataPreProcessors.constructor==Array&&r.dataPreProcessors.length>0)for(var i=0;i<r.dataPreProcessors.length;i++)t=r.dataPreProcessors[i](t,t[n],n,r)}return a},t),e.resultDataAttributes.scrollMoreFlag=!0,t.stream=ce.stream,t.other_params||(t.other_params={},t.other_params.fetch_lost=!1),(1==e.search_data.fetchLost||1==e.search_data.fetchLost||2==e.search_data.fetchLost&&!T(le))&&(t.other_params.fetch_lost=!0),e.search_data.lost&&(t.lost=!0),e.search_data.authenticated_only&&(t.authenticated_only=!0);var o={timeout:se.promise};e.isFetchingSelected=!0,1==t.stream&&(e.vResettingWaiting=!0),n.app_data.same_com_log||(t.rnd=0),e.dataTosend4Mail=angular.copy(t),delete e.dataTosend4Mail.stream,delete e.dataTosend4Mail.rnd,delete e.dataTosend4Mail.lost;try{e.reportingFun.fetchingProfiles({dataTosend:t,api:"./search/UserSearch"})}catch(e){}return r.postDataConfigCall("./search/UserSearch",t,o,a)}function O(e){return e.map(function(e){return e.notMe=e.basic_info.uid!=n.app_data.uid,e.inNetwork=-1!=de.indexOf(String(e.basic_info.uui)),e}),e}function T(a){return e.isEmpty=!0,angular.forEach(a,function(a,t){"string"==typeof a?""!=a&&(e.isEmpty=!1):a.length>0&&(e.isEmpty=!1)}),e.isEmpty}function q(e,a,t){function n(e){var a;a=1==e.success&&null!=e.data?e:{data:0},t(a)}var i={type:e,id:a};return r.postDataCall("./search/getCount",i,n)}function E(e,a,t,n){var r={name:e,uui:a,uid:t};s.openSendBox(r,n.target)}function A(e){snackbar_general("Added to "+t("asLingo")("35"),2500),de.push(e)}function R(a){var t="",n=[];return angular.forEach(a,function(a,r){if(0!=a.length){if(!e.search_data.fields[r])return;e.search_data.fields[r].isFieldChecked=!0,""!=t&&(t+=" and"),t=t+" "+e.search_data.fields[r].actionString;for(var i=0;i<a.length;i++)void 0!=e.search_data.fields[r].vCheckboxes[a[i]]&&(e.search_data.fields[r].hidden||n.push({key:r,value:e.search_data.fields[r].vCheckboxes[a[i]].name,id:e.search_data.fields[r].vCheckboxes[a[i]].id}),t=0==i?t+" "+e.search_data.fields[r].vCheckboxes[a[i]].name:t+" or "+e.search_data.fields[r].vCheckboxes[a[i]].name)}else e.search_data.fields[r].isFieldChecked=!1}),e.queryString=n,e.displayName=t,{searchString:t,queryString:n}}function $(a,t){e.search_data.fields[t].vCheckboxes[a].checked=!1,e.vBoxChanged(a,t,!0)}function M(){var e=angular.copy(ue);return console.log("_search_data",e),e.fields=Object.keys(e.fields).reduce(function(a,t){var n=e.fields[t];if(n.restrictionFunctions&&n.restrictionFunctions.constructor==Array&&n.restrictionFunctions.length>0)for(var r=0;r<n.restrictionFunctions.length;r++)if(n.restrictionFunctions[r](t,n))return a;return a[t]=n,a},{}),e}function U(e){return n.isMobile&&!isNaN(e.mobile_default_category)&&e.categories?(e.categories=e.categories.reduce(function(a,t,n){return n==e.mobile_default_category?a.unshift(t):a.push(t),a},[]),e):e}function B(){1==e.options.setFormFields?W().then(function(){j()}):j()}function j(){var a=M();a=U(a),e.searchInitialData?e.search_data=angular.copy(angular.merge(a,e.searchInitialData)):e.search_data=angular.copy(a),v();var t={queryString:angular.copy(le),other_params:{}},n=t.queryString;n=Object.keys(n).reduce(function(a,t){if(e.search_data.fields[t]){var r=e.search_data.fields[t];if(r.dataPreProcessors&&r.dataPreProcessors.constructor==Array&&r.dataPreProcessors.length>0)for(var i=0;i<r.dataPreProcessors.length;i++)n=r.dataPreProcessors[i](n,n[t],t,r)}return a},n),t.queryString=n,e.search_data.fetchLost&&(1==e.search_data.fetchLost||1==e.search_data.fetchLost||2==e.search_data.fetchLost&&!T(le))&&(t.other_params={fetch_lost:!0}),e.search_data.lost&&(t.queryString.lost=!0),e.search_data.authenticated_only&&(t.queryString.authenticated_only=!0),e.vResettingWaiting=!0,e.isFetchingSelected=!0,as_upgrade(300),t.selectiveCheckbox=!0,t.requiredCheckboxes=e.search_data.categories.reduce(function(e,a){return e=e.concat(a.fields)},[]);try{e.reportingFun.fetchingProfiles({dataTosend:t,api:"./search/index_api"})}catch(e){}r.postDataConfigCall("./search/index_api",t,{},y)}function W(){return a.post("./communities/communities/custom/extra_userprofile_info",{infoType:"*"}).then(function(a){if(a.data&&1==a.data.success&&a.data.data&&a.data.data.length>0){var t=a.data.data.filter(function(e){return(1===e.searchable||2===e.searchable&&n.app_data.isAdmin)&&-1!==[1,2,4,5,6,8].indexOf(parseInt(e.type))});t.length>0&&(e.searchInitialData.fields=t.reduce(function(e,a){var t=!1;-1!==[3,4,5].indexOf(parseInt(a.type))?t="dropdown":-1!==[1,2,6,8].indexOf(parseInt(a.type))&&(t="inputBox1");var n={displayName:a.title,actionString:"with "+a.title+":",futherSearchParams:{placeholder:"Select "+a.title,serviceNameField:"name",serviceIdField:"id"},countsRequired:!1,dataPreProcessors:[function(e,n,r){return n&&0!=n.length?(e.form||(e.form={}),e.form.form_id||(e.form.form_id=[]),e.form.fields||(e.form.fields={}),-1==e.form.form_id.indexOf(parseInt(a.form_id))&&e.form.form_id.push(parseInt(a.form_id)),e.form.fields["field_id_"+a.id]=angular.merge(e.form.fields["field_id_"+a.id]?e.form.fields["field_id_"+a.id]:[],n),"inputBox1"===t&&(e.form.fieldsparams||(e.form.fieldsparams={}),e.form.fieldsparams[a.id]={},e.form.fieldsparams[a.id].match_type="non-strict"),e):e}]};return"dropdown"===t?(n.futherSearchType="dropdown",n.futherSearchParams.dropdownList=a.data&&a.data.map(function(e,a){return{id:e,name:e}},{})):"inputBox1"===t&&(n.futherSearchType="inputBox1",n.futherSearchParams.placeholder="Search by "+a.title+"...",n.futherSearchParams.idSelected=-1,n.futherSearchParams.textSelected="",n.futherSearchParams.smallInputBox=!0),t&&a.empty_searchable&&(n.vCheckboxes={___empty___:{id:"___empty___",name:"is Empty",checked:!1}}),a.name?e[a.name]=n:e[a.title]=n,e},{}),e.searchInitialData.categories.push({fields:t.map(function(e){return e.name?e.name:e.title}),displayName:"More filters",display:!1}))}})}function G(){if(le={},e.searchInitialData&&e.searchInitialData.contextSearch)return void B();N(le),H(le),angular.forEach(e.search_data.categories,function(a){angular.forEach(a.fields,function(a){angular.isDefined(e.search_data.fields[a].futherSearchParams)&&(e.search_data.fields[a].futherSearchParams.textSelected="")})})}function H(e){S(),D(e),T(e),L(e),R(e)}function J(t,n){if(e.searchInitialData&&e.searchInitialData.dataParams&&e.searchInitialData.dataParams.tags&&e.searchInitialData.dataParams.tags[0]){var r={tag_id:e.searchInitialData.dataParams.tags[0]};return a.post("./tags/fetch",r).then(function(a){a&&a.data&&1==a.data.success&&a.data.data&&(e.search_data.fields[t].futherSearchParams.dropdownList=[{id:a.data.data.id,name:a.data.data.name}])})}}function K(a,t){for(var r=[],i=(new Date).getFullYear(),o=i+5;o>=n.app_data.data.establish_year;o--)r.push({id:o,name:o});return e.search_data.fields[a].futherSearchParams.dropdownList=r,r}function Y(e,a,t){13===(e.which||e.keyCode)&&C(t,a)}function V(a){var t=e.displayName,n=Object.keys(le).reduce(function(a,t){if(-1!==["stream","other_params","rnd"].indexOf(t))return a;if(e.search_data.fields[t]){var n=e.search_data.fields[t];if(n.dataPreProcessors&&n.dataPreProcessors.constructor==Array&&n.dataPreProcessors.length>0)for(var r=0;r<n.dataPreProcessors.length;r++)le=n.dataPreProcessors[r](le,le[t],t,n)}return a},le),r=z(n);r=""==r?"?other_params[fetch_lost]=true":"?"+r+"&other_params[fetch_lost]=true";var i="search/download_new/"+encodeURIComponent(t.replace(/[^\w ]/g," ").replace(/ +/g," "))+r,o={};if(e.adminPasswordContainer){var s=document.getElementById(e.adminPasswordContainer);if(s)return void l.do(window.API_BASE_URL+i,"csv","text/csv")}else m.withConfirmation(i,o)}function z(e,a){if(a||(a=""),"object"!=typeof e)return"undefined"!=typeof console&&console.log('"srcjson" is not a JSON object'),null;for(var t=encodeURIComponent,n="",r=Object.keys(e),i=0;i<r.length;i++){var o=a?a+"["+r[i]+"]":r[i];"object"!=typeof e[r[i]]?n+=t(o)+"="+t(e[r[i]]):n+=z(e[r[i]],o),i<r.length-1&&(n+="&")}return n}function Q(e){return function(){return!e.apply(null,arguments)}}function X(){return n.app_data.isAdmin}function Z(a){return h(function(){e.search_data.more_filters=a},100),!1}function ee(e){e.emailInput=!0,as_upgrade(50)}function ae(a,t,r){console.log("inviteVia","type:",a,"ev:",t,"user:",r);r.name;if(e.facebookUrl=window.COMM_APPBASE+"invite/2/"+n.app_data.cid+"/"+n.app_data.uid,e.facebookUrl+="/search","email"==a&&u.byEmail(t,{reason:"search"}),"whatsapp"==a&&u.byWhatsapp(t,{reason:"search",name:r.basic_info.name}),"facebook"==a&&u.byFacebook(t,{reason:"search",name:r.basic_info.name}),"email_input"==a){console.log(r),r.invitationSending=!0;var i={lost:r.basic_info.uid},o=r.basic_info.name;u.byEmailInput(o,r.email,i,function(e){r.invitationSending=!1,1==e.success&&(r.basic_info.is_lost_user=0,r.invited=!0,r.emailInput=!1,snackbar_general(r.basic_info.name+" has been invited.",2e3)),e.message&&snackbar_general(e.message,2e3)})}}function te(e){f.bySignup(e.uui,e.basic_info.name)}function ne(e){f.claimProfile(e.uui)}function re(){var a,t;if(e.isEmpty)a=e.totalCount.count,t="All Users";else{if(null==e.queryString)return;a=e.resultCount[0].count,t=e.displayName.length>0?"Users "+e.displayName:a+" user"+(a>1?"s":"")}var n={type:1,count:a};n.paramsArray=e.dataTosend4Mail,n.query_string=t,g.clone({content:"",mailing_list:[n],myRecepients:"2"})}function ie(a,t){function n(t){var n=[];return angular.forEach(t.data.childs,function(e,t){"groups"===a?n.push({id:e.id,name:e.name}):"chapters"===a&&angular.forEach(e.childs,function(e,a){n.push({id:e.id,name:e.name})})}),e.search_data.fields[a].futherSearchParams.dropdownList=n,n}return r.postDataCall(t.serviceLink,t.paramsToSend,n)}var oe,se,ce={},de=[],le={},he={sNumber:0,sTime:0};isObject(e.options)||(e.options={sendMailEnabled:!0}),e.tippyOption={arrow:!0,theme:e.tipShow?"excited":"dark",zIndex:999,dynamicTitle:!0,duration:[300,1e3]},e.vResettingWaiting=!0,e.isEmpty=!0,e.resultDataAttributes={},e.resultProfiles=[];var ue={fields:{name:{displayName:"Keyword",actionString:"with",futherSearchType:"inputBox",futherSearchParams:{query:13,placeholder:"Enter Keyword..",idSelected:-1,textSelected:"",serviceNameField:"name",serviceIdField:"id"},countsRequired:!1,singleSearch:!0},life_membership_number:{displayName:t("asLingo")("23")+" ID",actionString:"with",futherSearchType:"inputBox",parentClass:"margin-bottom-10",futherSearchParams:{placeholder:"Enter "+t("asLingo")("23")+" ID",idSelected:-1,textSelected:"",serviceNameField:"name",serviceIdField:"id"},countsRequired:!1,singleSearch:!0,restrictionFunctions:[Q(X),function(){return 1!=n.app_data.data.life_membership_provision}]},life_membership_status:{displayName:t("asLingo")("23")+" Status",actionString:"who are",futherSearchType:"dropdown",parentClass:"margin-bottom-10",futherSearchParams:{placeholder:"--Select "+t("asLingo")("23")+" Status--",serviceNameField:"name",serviceIdField:"id",dropdownList:[{id:1,name:t("asLingo")("22")},{id:2,name:"Not "+t("asLingo")("22")}]},countsRequired:!1,singleSearch:!0,restrictionFunctions:[Q(X),function(){return 1!=n.app_data.data.life_membership_provision}]},tags:{displayName:"Chapter name",actionString:"Members of ",hidden:!0,futherSearchType:"dropdown",parentClass:"margin-bottom-10",futherSearchParams:{serviceNameField:"name",serviceIdField:"id"},countsRequired:!1,singleSearch:!0,preqFunctions:[{fName:J}]},bounceEmail:{displayName:"Bounced Email",actionString:"Bounced Email ",hidden:!0,futherSearchType:"dropdown",futherSearchParams:{serviceNameField:"name",serviceIdField:"id",dropdownList:[{id:0,name:"All"},{id:1,name:"Bounced Email"}]},countsRequired:!1,singleSearch:!0},unSubscribedEmail:{displayName:"Unsubscribed Email",actionString:"Unsubscribed Email ",hidden:!0,futherSearchType:"dropdown",futherSearchParams:{serviceNameField:"name",serviceIdField:"id",dropdownList:[{id:0,name:"All"},{id:2,name:"Unsubscribed Email"}]},countsRequired:!1,singleSearch:!0},activeStatus:{displayName:"Active Status",actionString:"activeStatus  ",hidden:!0,futherSearchType:"dropdown",futherSearchParams:{serviceNameField:"name",serviceIdField:"id",dropdownList:[{id:0,name:"All Users"},{id:1,name:"Active Users"},{id:2,name:"Never Active Users"},{id:3,name:"Active Users of Last 3 Months"}]},countsRequired:!1,singleSearch:!0},adminRights:{displayName:"Admin Rights",actionString:"Admin Rights ",hidden:!0,futherSearchType:"dropdown",futherSearchParams:{serviceNameField:"name",serviceIdField:"id",dropdownList:[{id:0,name:"Super Admin"}]},countsRequired:!1,singleSearch:!0},company:{displayName:t("asLingo")("44"),actionString:"Work At",futherSearchType:"autocomplete",futherSearchParams:{query:13,placeholder:t("asLingo")("44")+" Name",idSelected:-1,textSelected:"",serviceNameField:"name",serviceIdField:"id"},countsRequired:!0},city:{displayName:t("asLingo")("43"),actionString:"Living in",futherSearchType:"autocomplete",futherSearchParams:{query:12,placeholder:"Location",idSelected:-1,textSelected:"",serviceNameField:"name",serviceIdField:"id",autocomplete_Options:{postData:{params:{country:!0,region:!0}}}},countsRequired:!0},hometown:{displayName:"Hometown",actionString:"from hometown",futherSearchType:"autocomplete",futherSearchParams:{query:12,placeholder:"Location",idSelected:-1,textSelected:"",serviceNameField:"name",serviceIdField:"id",autocomplete_Options:{postData:{params:{country:!0,region:!0}}}},countsRequired:!0},department:{displayName:t("asLingo")("5"),actionString:"from "+t("asLingo")("5"),futherSearchType:"dropdown",futherSearchParams:{placeholder:"--Select a "+t("asLingo")("5")+"--",serviceNameField:"department",serviceIdField:"id"},countsRequired:!0,preqFunctions:[{fName:k,expectedSchema:["data"],paramsToSend:{id:n.app_data.cid},removeIfNoData:!0,serviceLink:"./signuser/departmentGet/1"}]},degree:{displayName:t("asLingo")("13"),actionString:"from "+t("asLingo")("13"),futherSearchType:"dropdown",futherSearchParams:{placeholder:"--Select a "+t("asLingo")("13")+"--",serviceNameField:"degree",serviceIdField:"id"},countsRequired:!0,preqFunctions:[{fName:k,expectedSchema:["data"],paramsToSend:{id:n.app_data.cid},removeIfNoData:!0,serviceLink:"./signuser/degreesGet/1"}]},yop:{displayName:t("asLingo")("3"),actionString:"from "+t("asLingo")("3"),futherSearchType:"dropdown",futherSearchParams:{placeholder:"--Select a "+t("asLingo")("3")+"--",serviceNameField:"name",serviceIdField:"id",dropdownOrderbyRev:!0},countsRequired:!0,preqFunctions:[{fName:K}]},sector:{displayName:t("asLingo")("7"),actionString:"from "+t("asLingo")("7"),futherSearchType:"dropdown",futherSearchParams:{placeholder:"--Select a "+t("asLingo")("7")+"--",serviceNameField:"name",serviceIdField:"id"},countsRequired:!0,preqFunctions:[{fName:k,expectedSchema:[],serviceLink:"./jobs/fetch_all_sectors"}]},subinst:{displayName:t("asLingo")("45"),actionString:"from",futherSearchType:"dropdown",futherSearchParams:{placeholder:"--Select "+t("asLingo")("45")+" --",serviceNameField:"name",serviceIdField:"id",dropdownList:n.app_data.data.child_institutes&&n.app_data.data.child_institutes.map(function(e){return{name:e.sub_name,id:e.sub_cid}})},countsRequired:!0,restrictionFunctions:[function(){return 3!=n.app_data.data.insti_type}]},skill:{displayName:t("asLingo")("42"),actionString:"Having "+t("asLingo")("42")+" in",futherSearchType:"autocomplete",futherSearchParams:{query:15,placeholder:"Search "+t("asLingo")("42"),idSelected:-1,textSelected:"",serviceNameField:"name",serviceIdField:"id"},countsRequired:!0},role:{displayName:"Search for",actionString:"is ",futherSearchType:"dropdown",futherSearchParams:{placeholder:"--Select--",serviceNameField:"name",serviceIdField:"id",dropdownList:[{id:0,name:"All"}]},countsRequired:!1,singleSearch:!0,preqFunctions:[{fName:function(){var a=[];a.push({id:1,name:t("asRoleLingo")(1,"Student")}),a.push({id:3,name:t("asRoleLingo")(3,"Alumni")}),6!=n.app_data.data.insti_type&&a.push({id:2,name:t("asRoleLingo")(2,"Faculty")}),a.push({id:4,name:t("asRoleLingo")(4,"Admin")}),e.search_data.fields.role.futherSearchParams.dropdownList=a}}]},gender:{displayName:"Gender",actionString:"of Gender",futherSearchType:"dropdown",futherSearchParams:{placeholder:"--Select Gender--",serviceNameField:"name",serviceIdField:"id",dropdownList:[{id:1,name:"Male"},{id:2,name:"Female"}]},countsRequired:!1,preqFunctions:[],restrictionFunctions:[Q(X)]},designation:{displayName:"Designation",actionString:"Working as ",futherSearchType:"autocomplete",futherSearchParams:{query:17,placeholder:"Search Designation",idSelected:-1,textSelected:"",serviceNameField:"name",serviceIdField:"id"},countsRequired:!0},industry:{displayName:t("asLingo")("41"),actionString:"In "+t("asLingo")("41"),futherSearchType:"autocomplete",futherSearchParams:{query:20,placeholder:"Search "+t("asLingo")("41"),idSelected:-1,textSelected:"",serviceNameField:"name",serviceIdField:"id"},countsRequired:!0},job_switch:{displayName:"Job Seeker",actionString:"Who are",hidden:!0,futherSearchType:"dropdown",futherSearchParams:{placeholder:"--Select Option--",serviceNameField:"name",serviceIdField:"id",dropdownList:[{id:0,name:"Actively Applying for Job"},{id:1,name:"Casually Looking for Job"}]},countsRequired:!1},job_provider_switch:{displayName:"Job Provider",actionString:"Who are",hidden:!0,futherSearchType:"dropdown",futherSearchParams:{placeholder:"--Select Option--",serviceNameField:"name",serviceIdField:"id",dropdownList:[{id:0,name:"Job Provider"},{id:1,name:"Job Referrer"}]},countsRequired:!1},internship_switch:{displayName:"Internship Seeker",actionString:"Who are",hidden:!0,futherSearchType:"dropdown",futherSearchParams:{placeholder:"--Select Option--",serviceNameField:"name",serviceIdField:"id",dropdownList:[{id:0,name:"Actively Applying for Internship"},{id:1,name:"Casually Looking for Internship"}]},countsRequired:!1},internship_provider_switch:{displayName:"Internship Provider",actionString:"Who are",hidden:!0,futherSearchType:"dropdown",futherSearchParams:{placeholder:"--Select Option--",serviceNameField:"name",serviceIdField:"id",dropdownList:[{id:0,name:"Internship Provider"},{id:1,name:"Internship Referrer"}]},countsRequired:!1},socialIntegration:{displayName:"Social Integration Status",actionString:"selectedIntegration",hidden:!0,futherSearchType:"dropdown",futherSearchParams:{serviceNameField:"name",serviceIdField:"id",dropdownList:[{id:0,name:"Google"},{id:1,name:"Linkedin"},{id:2,name:"Facebook"}]},countsRequired:!1,singleSearch:!0},user_metadata_filter:{displayName:"user_metadata_filter",actionString:"with",hidden:!0,futherSearchType:"dropdown",countsRequired:!1,singleSearch:!0},chapters:{displayName:"Chapters",actionString:"from chapter ",futherSearchType:"dropdown",futherSearchParams:{placeholder:"--Select a Chapter--",serviceNameField:"name",serviceIdField:"id"},countsRequired:!1,preqFunctions:[{fName:ie,paramsToSend:{tag_name:"#chapters"},removeIfNoData:!0,serviceLink:"./tags/fetch"}]},groups:{displayName:"Groups",actionString:"from group ",futherSearchType:"dropdown",futherSearchParams:{placeholder:"--Select a Group--",serviceNameField:"name",serviceIdField:"id"},countsRequired:!1,preqFunctions:[{fName:ie,paramsToSend:{tag_name:"#groups"},removeIfNoData:!0,serviceLink:"./tags/fetch"}]}},categories:[{fields:["name"],displayName:"Keyword"}],initConfigurations:{initCheckboxes:!1,initNetwork:!1,totalCount:!1},dataParams:{},fetchLost:!1,mobile_default_category:0};angular.isUndefined(e.startSearchNow)&&h(function(){(e.startSearchNow||{}).start=B},500),(e.startSearchNow||{}).start=B,e.autocompleteSelected=w,e.filterDropdownOnChange=x,e.vBoxChanged=F,e.vFetchProfiles=L,e.messageBtnClick=E,e.updateNetList=A,e.vCrossButton=$,e.vResetAll=G,e.inputBoxSelected=C,e.inputBoxKeyPressed=Y,e.isAllowed=d.isAllowed,e.download=V,e.showMoreToggle=Z,e.allow_email=ee,e.inviteVia=ae,e.claim_profile=te,e.claim_profile2=ne,e.mail=re,e.close=_}angular.module("as.search").directive("searchMaster",e).controller("searchMasterController",a),e.$inject=["$http","$compile"],a.$inject=["$scope","$http","$filter","$rootScope","sidetopHttp","$q","$state","asMessages","$stateParams","adminRights","fileDownload","$timeout","invitation","$location","downloadDatabase","claimProfile","adminMailClone"]}(),function(){"use strict";function e(e,a,t,n,r,i,o,s,c,d,l,h,u,p,m,f){function g(t){e.resetting_waiting=!1,angular.element(r).bind("resize",function(){N(!0)});var n=t.data;console.log("pala",n),e.isAdmin=n.downloadPermit,angular.isUndefined(n)||(console.log(n),Ee=1==n.checkboxes.success?n.checkboxes:{},Ae=n.network?n.network:[],$e=1==n.people.success?n.peopele:{},Re=!!n.downloadPermit&&n.downloadPermit),e.totalCount=n.totalCount,1==n.people.success?e.resultProfiles=n.people.data:e.resultProfiles=[],L(),q(),A(),M(),De=B(["subinst"],De),j(),O(),angular.forEach(ye,function(e,a){void 0!==d[a]&&("string"==typeof d[a]&&"name"!=a?ye[a].push(d[a]):ye[a]=d[a])}),void 0===a.search().name||""===a.search().name?ye.name="":ye.name=a.search().name,void 0===a.search().role||""===a.search().role||0===a.search().role?(ye.role=[],e.optionSelected="0"):(ye.role=[a.search().role],e.optionSelected=a.search().role),e.pName={},e.pName.basic_info={},e.pName.basic_info.name=ye.name,e.displayName=ye.name,console.log(e.pName.basic_info.name),angular.isDefined(Ee.data)&&angular.isDefined(Ee.data.company)?e.companyCheckboxes=Ee.data.company:e.companyCheckboxes={},angular.isDefined(Ee.data)&&angular.isDefined(Ee.data.designation)?e.designationCheckboxes=Ee.data.designation:e.designationCheckboxes={},angular.isDefined(Ee.data)&&angular.isDefined(Ee.data.city)?e.citiesCheckboxes=Ee.data.city:e.citiesCheckboxes={},angular.isDefined(Ee.data)&&angular.isDefined(Ee.data.hometown)?e.hometownCheckboxes=Ee.data.hometown:e.hometownCheckboxes={},angular.isDefined(Ee.data)&&angular.isDefined(Ee.data.department)?e.departmentCheckboxes=Ee.data.department:e.departmentCheckboxes={},angular.isDefined(Ee.data)&&angular.isDefined(Ee.data.degree)?e.degreeCheckboxes=Ee.data.degree:e.degreeCheckboxes={},angular.isDefined(Ee.data)&&angular.isDefined(Ee.data.yop)?e.yopCheckboxes=Ee.data.yop:e.yopCheckboxes={},angular.isDefined(Ee.data)&&angular.isDefined(Ee.data.sector)?e.sectorCheckboxes=Ee.data.sector:e.sectorCheckboxes={},angular.isDefined(Ee.data)&&angular.isDefined(Ee.data.skill)?e.skillCheckboxes=Ee.data.skill:e.skillCheckboxes={},angular.isDefined(Ee.data)&&angular.isDefined(Ee.data.gender)?e.genderCheckboxes=Ee.data.gender:e.genderCheckboxes={},qe.length>0&&ne(),angular.element(r).bind("scroll",function(){try{var a=document.getElementById("resultsDiv"),t=a.offsetHeight,n=document.getElementById("countDiv"),r=n.offsetHeight,i=document.getElementById("filtersDiv"),o=i.offsetHeight;window.pageYOffset+window.innerHeight+r+o+75>=t&&0===Fe&&(!0===e.isEmpty||!1===e.seemoreHide?e.allLoadMore():!1===e.isEmpty&&e.selectedLoadMore(),as_upgrade(100))}catch(e){}}),e.queryString=ce(),e.year=[];for(var i=(new Date).getFullYear(),o=i+5;o>=ke;o--)e.year.push({key:o,value:o});pe(),e.$on("$destroy",function(){angular.element(r).off("scroll"),angular.element(r).off("resize")});var s=h.href(h.current.name,a.search(),{absolute:!0});""!==u.app_data.data.baseState&&(s=s.split(u.app_data.data.baseState)[1],s="/"+u.app_data.data.baseState+s),e.href=s}function y(e){e.emailInput=!0,as_upgrade(50)}function _(t,n,r){var i=a.search(),o=0,s="",c="";if(angular.forEach(i,function(e,a){"source"!==a&&(s+=(o?",":"|")+a+":"+e,c+=(o?"&":"?")+a+"="+e,o+=1)}),e.facebookUrl=window.COMM_APPBASE+"invite/2/"+u.app_data.cid+"/"+u.app_data.uid,e.facebookUrl+="/search"+c,"email"==t&&m.byEmail(n,{reason:"search"+s}),"whatsapp"==t&&m.byWhatsapp(n,{reason:"search"+c,name:r.basic_info.name}),"facebook"==t&&m.byFacebook(n,{reason:"search"+c,name:r.basic_info.name}),"email_input"==t){console.log(r),r.invitationSending=!0;var d={lost:r.basic_info.uid},l=r.basic_info.name;m.byEmailInput(l,r.email,d,function(e){r.invitationSending=!1,1==e.success&&(r.basic_info.is_lost_user=0,r.invited=!0,r.emailInput=!1,snackbar_general(r.basic_info.name+" has been invited.",2e3)),e.message&&snackbar_general(e.message,2e3)})}}function S(){var t=h.href(h.current.name,a.search(),{absolute:!0});""!==u.app_data.data.baseState&&(t=t.split(u.app_data.data.baseState)[1],t="/"+u.app_data.data.baseState+t),console.log("chnggg ",t),e.href=t}function b(){-1!=e.company_id&&(V("company"),ve="Company")}function v(){-1!=e.designation_id&&(V("designation"),ve="designation")}function k(){-1!=e.location_id&&(V("city"),ve="City")}function w(){-1!=e.hometown_id&&(V("hometown"),ve="hometown")}function x(){-1!=e.subinst_id&&(V("subinst"),ve="Sub-Institute")}function C(){-1!=e.department_id&&(V("department"),ve="Department")}function P(){-1!=e.degree_id&&(V("degree"),ve="Degree")}function F(){-1!=e.yop_id&&(e.yop_name=e.yop_id,V("yop"),ve="YOP")}function N(a){window.innerWidth<480?e.hideFilterSection=!0:e.hideFilterSection=!1,!0===a&&e.$apply()}function D(){window.innerWidth<480&&(!1===e.showDrawer?(e.showDrawer=!0,document.body.style.overflow="hidden"):(e.showDrawer=!1,document.body.style.overflow="visible"))}function I(){Pe=1,e.showDrawer=!1,
delete ye.role,1==e.optionSelected||2==e.optionSelected||3==e.optionSelected||4==e.optionSelected?(ye.role=[e.optionSelected],h.go("inapp.search",ye,{notify:!1,location:"replace"}),te(),ne(),pe(),e.queryString=ce()):0===e.optionSelected&&(h.go("inapp.search",ye,{notify:!1,location:"replace"}),pe(),e.queryString=ce(),!1===e.isEmpty&&(te(),ne()))}function L(){function a(a){angular.isUndefined(a.data)||(e.departments=a.data),e.selecftedDept=e.departments[0]}return l.postDataCall("./signuser/departmentGet/1",Ie,a)}function O(){e.roles=[{code:1,name:"Students"},{code:3,name:"Alumni"},{code:2,name:"Faculty"},{code:4,name:"Admin"}],6==u.app_data.data.insti_type&&(e.roles=[{code:1,name:"Current Employees"},{code:3,name:"Past Employees"},{code:4,name:"Admin"}])}function T(a){return e.roles.reduce(function(e,t){return t.code==a&&(e=t.name),e},"")}function q(){return l.postCall("./jobs/fetch_all_sectors",E)}function E(a){return e.sectors=a,a}function A(){return l.postCall("./jobs/fetch_all_skills",R)}function R(a){return e.skills=a,a}function $(a){e.department_id=a.id,e.department_name=a.department}function M(){function a(a){angular.isUndefined(a.data)||(e.degrees=a.data),e.selectedDeg=e.degrees[0]}return l.postDataCall("./signuser/degreesGet/1",Ie,a)}function U(a){e.degree_id=a.id,e.degree_name=a.degree}function B(e,a){for(var t=e.length-1;t>=0;t--)d[e[t]],angular.isDefined(d[e[t]])&&(angular.isArray(d[e[t]])?angular.extend(a,d[e[t]]):a.push(d[e[t]]));return a}function j(){function a(a){if(e.sub_inst_successful=a.success,1==a.success){var t=0;for(var n in a.count)if(t++,e.subInstCheckboxes[n]=a.count[n],t==Ne)break;if(e.allSubInst=a.count,e.colleges=a.data,e.selectedCollege=e.colleges[0],De.length>0)for(var r=0;r<De.length;r++)G(De[r],e.allSubInst[De[r]].name,e.allSubInst[De[r]].count)}else e.subInstCheckboxes=[],e.colleges=[],e.allSubInst=[]}return l.postDataCall("./search/getSubInst_c/1",Ie,a)}function W(a){e.subinst_id=a.sub_insti_cid,e.subinst_name=a.name}function G(a,t,n){var r={id:a,name:t,checked:!0,count:n};e.subInstCheckboxes[r.id]=r,-1==ye.subinst.indexOf(a)&&ye.subinst.push(a),e.queryString=ce()}function H(){ye={},h.go("inapp.search",ye,{notify:!1,location:"replace"}),e.optionSelected="0";var a=["companyCheckboxes","designationCheckboxes","citiesCheckboxes","hometownCheckboxes","departmentCheckboxes","degreeCheckboxes","subInstCheckboxes","yopCheckboxes","sectorCheckboxes","skillCheckboxes","genderCheckboxes"];angular.forEach(a,function(a){angular.forEach(e[a],function(e){e.checked=!1})}),e.checked_category={},e.queryString=[],pe(),ye.company=[],ye.city=[],ye.department=[],ye.degree=[],ye.yop=[],ye.subinst=[],ye.sector=[],ye.skill=[],ye.gender=[],ye.hometown=[],ye.designation=[],delete ye.role,e.pName.basic_info.name="",e.displayName=""}function J(){V("sector"),ve="sector"}function K(){V("skill"),ve="skill"}function Y(){V("gender"),ve="gender"}function V(a){var t;"company"==a?(t={id:e.company_id,name:e.company_name,checked:!0},re("company",t.id,function(n){t.count=n.data,e.companyCheckboxes[t.id]=t,e.boxChanged(e.company_id,a),e.company_id=-1,e.company_name=""})):"designation"==a?(t={id:e.designation_id,name:e.designation_name,checked:!0},re("designation",t.id,function(n){t.count=n.data,e.designationCheckboxes[t.id]=t,e.boxChanged(e.designation_id,a),e.designation_id=-1,e.designation_name=""})):"city"==a?(t={id:e.location_id,name:e.location_name,checked:!0},re("city",t.id,function(n){t.count=n.data,e.citiesCheckboxes[t.id]=t,e.boxChanged(t.id,a),e.location_id=-1,e.location_name=""})):"hometown"==a?(t={id:e.hometown_id,name:e.hometown_name,checked:!0},re("hometown",t.id,function(n){t.count=n.data,e.citiesCheckboxes[t.id]=t,e.boxChanged(t.id,a),e.hometown_id=-1,e.hometown_name=""})):"subinst"==a?(t={id:e.subinst_id,name:e.subinst_name,checked:!0,count:e.allSubInst[e.subinst_id].count},e.subInstCheckboxes[t.id]=t,e.boxChanged(t.id,a),e.subinst_id=-1,e.subinst_name=""):"department"==a?(t={id:e.department_id,name:e.department_name,checked:!0},re("department",t.id,function(n){t.count=n.data,e.departmentCheckboxes[t.id]=t,e.boxChanged(t.id,a),e.department_id=-1,e.department_name=""})):"degree"==a?(t={id:e.degree_id,name:e.degree_name,checked:!0},re("degree",t.id,function(n){t.count=n.data,e.degreeCheckboxes[t.id]=t,e.boxChanged(t.id,a),e.degree_id=-1,e.degree_name=""})):"yop"==a?(t={id:e.yop_id,name:e.yop_name,checked:!0},re("year",t.id,function(n){t.count=n.data,e.yopCheckboxes[t.id]=t,e.boxChanged(t.id,a),e.yop_id=-1,e.yop_name=""})):"sector"==a?(t={id:e.selectedSect.id,name:e.selectedSect.name,checked:!0},re("sector",t.id,function(n){t.count=n.data,e.sectorCheckboxes[t.id]=t,e.boxChanged(t.id,a),e.selectedSect={}})):"skill"==a?(t={id:e.selectedSkill.id,name:e.selectedSkill.name,checked:!0},re("sector",t.id,function(n){t.count=n.data,e.skillCheckboxes[t.id]=t,e.boxChanged(t.id,a),e.selectedSkill={}})):"gender"==a&&(t={id:e.selectedGender.id,name:e.selectedGender.name,checked:!0},re("sector",t.id,function(n){t.count=n.data,e.genderCheckboxes[t.id]=t,e.boxChanged(t.id,a),e.selectedGender={}}))}function z(a,t,n){as_upgrade(10),!angular.isUndefined(n)&&n||e.toggleDrawer();var i=Le.getBoundingClientRect().top+window.pageYOffset;scrollTo(i-150,100),Pe=1,Fe=0,r.innerWidth<992&&(e.ProbarShown=!1),be=t,"company"==t?(!0===e.companyCheckboxes[a].checked?(-1==ye.company.indexOf(a)&&ye.company.push(a),ne(),te()):(ye.company.splice(ye.company.indexOf(a),1),ye.company.length>0?(ne(),te()):0==ye.designation.length&&0==ye.hometown.length&&0==ye.gender.length&&0===ye.sector.length&&0===ye.skill.length&&0==ye.city.length&&0==ye.department.length&&0==ye.degree.length&&0==ye.yop.length&&""==ye.name&&0==ye.subinst.length&&angular.isUndefined(ye.role)?e.resultProfiles=[]:(ne(),te())),h.go("inapp.search",ye,{notify:!1,location:"replace"})):"designation"==t?(!0===e.designationCheckboxes[a].checked?(-1==ye.designation.indexOf(a)&&ye.designation.push(a),ne(),te()):(ye.designation.splice(ye.designation.indexOf(a),1),ye.designation.length>0?(ne(),te()):0==ye.company.length&&0==ye.hometown.length&&0==ye.gender.length&&0===ye.sector.length&&0===ye.skill.length&&0==ye.city.length&&0==ye.department.length&&0==ye.degree.length&&0==ye.yop.length&&""==ye.name&&0==ye.subinst.length&&angular.isUndefined(ye.role)?e.resultProfiles=[]:(ne(),te())),h.go("inapp.search",ye,{notify:!1,location:"replace"})):"city"==t?(1==e.citiesCheckboxes[a].checked?(-1==ye.city.indexOf(a)&&ye.city.push(a),ne(),te()):(ye.city.splice(ye.city.indexOf(a),1),ye.city.length>0?(ne(),te()):0==ye.designation.length&&0==ye.hometown.length&&0==ye.gender.length&&0==ye.sector.length&&0==ye.skill.length&&0==ye.company.length&&0==ye.department.length&&0==ye.degree.length&&0==ye.yop.length&&""==ye.name&&0==ye.subinst.length&&angular.isUndefined(ye.role)?e.resultProfiles=[]:(ne(),te())),h.go("inapp.search",ye,{notify:!1,location:"replace"})):"hometown"==t?(1==e.hometownCheckboxes[a].checked?(-1==ye.hometown.indexOf(a)&&ye.hometown.push(a),ne(),te()):(ye.hometown.splice(ye.hometown.indexOf(a),1),ye.hometown.length>0?(ne(),te()):0==ye.designation.length&&0==ye.city.length&&0==ye.gender.length&&0==ye.sector.length&&0==ye.skill.length&&0==ye.company.length&&0==ye.department.length&&0==ye.degree.length&&0==ye.yop.length&&""==ye.name&&0==ye.subinst.length&&angular.isUndefined(ye.role)?e.resultProfiles=[]:(ne(),te())),h.go("inapp.search",ye,{notify:!1,location:"replace"})):"subinst"==t?(1==e.subInstCheckboxes[a].checked?(-1==ye.subinst.indexOf(a)&&ye.subinst.push(a),ne(),te()):(ye.subinst.splice(ye.subinst.indexOf(a),1),ye.subinst.length>0?(ne(),te()):0==ye.designation.length&&0==ye.hometown.length&&0==ye.gender.length&&0==ye.sector.length&&0==ye.skill.length&&0==ye.company.length&&0==ye.city.length&&0==ye.department.length&&0==ye.degree.length&&0==ye.yop.length&&""==ye.name&&angular.isUndefined(ye.role)?e.resultProfiles=[]:(ne(),te())),h.go("inapp.search",ye,{notify:!1,location:"replace"})):"department"==t?(1==e.departmentCheckboxes[a].checked?(-1==ye.department.indexOf(a)&&ye.department.push(a),ne(),te()):(ye.department.splice(ye.department.indexOf(a),1),ye.department.length>0?(ne(),te()):0==ye.designation.length&&0==ye.hometown.length&&0==ye.gender.length&&0==ye.sector.length&&0==ye.skill.length&&0==ye.company.length&&0==ye.city.length&&0==ye.yop.length&&0==ye.degree.length&&""==ye.name&&0==ye.subinst.length&&angular.isUndefined(ye.role)?e.resultProfiles=[]:(ne(),te())),h.go("inapp.search",ye,{notify:!1,location:"replace"})):"degree"==t?(1==e.degreeCheckboxes[a].checked?(-1==ye.degree.indexOf(a)&&ye.degree.push(a),ne(),te()):(ye.degree.splice(ye.degree.indexOf(a),1),ye.degree.length>0?(ne(),te()):0==ye.designation.length&&0==ye.hometown.length&&0==ye.gender.length&&0==ye.sector.length&&0==ye.skill.length&&0==ye.company.length&&0==ye.city.length&&0==ye.yop.length&&0==ye.department.length&&""==ye.name&&0==ye.subinst.length&&angular.isUndefined(ye.role)?e.resultProfiles=[]:(ne(),te())),h.go("inapp.search",ye,{notify:!1,location:"replace"})):"yop"==t?(1==e.yopCheckboxes[a].checked?(-1==ye.yop.indexOf(a)&&ye.yop.push(a),ne(),te()):(ye.yop.splice(ye.yop.indexOf(a),1),ye.yop.length>0?(ne(),te()):0==ye.designation.length&&0==ye.hometown.length&&0==ye.gender.length&&0==ye.sector.length&&0==ye.skill.length&&0==ye.company.length&&0==ye.city.length&&0==ye.department.length&&0==ye.degree.length&&""==ye.name&&0==ye.subinst.length&&angular.isUndefined(ye.role)?e.resultProfiles=[]:(ne(),te())),h.go("inapp.search",ye,{notify:!1,location:"replace"})):"sector"==t?(1==e.sectorCheckboxes[a].checked?(console.log(ye),-1==ye.sector.indexOf(a)&&ye.sector.push(a),ne(),te()):(ye.sector.splice(ye.sector.indexOf(a),1),ye.sector.length>0?(ne(),te()):0==ye.designation.length&&0==ye.hometown.length&&0==ye.gender.length&&ye.skill&&0==ye.degree.length&&0==ye.company.length&&0==ye.city.length&&0==ye.yop.length&&0==ye.department.length&&""==ye.name&&0==ye.subinst.length&&angular.isUndefined(ye.role)?e.resultProfiles=[]:(ne(),te())),h.go("inapp.search",ye,{notify:!1,location:"replace"})):"skill"==t?(1==e.skillCheckboxes[a].checked?(-1==ye.skill.indexOf(a)&&ye.skill.push(a),ne(),te()):(ye.skill.splice(ye.skill.indexOf(a),1),ye.skill.length>0?(ne(),te()):0==ye.designation.length&&0==ye.hometown.length&&0==ye.gender.length&&0==ye.sector.length&&0==ye.degree.length&&0==ye.company.length&&0==ye.city.length&&0==ye.yop.length&&0==ye.department.length&&""==ye.name&&0==ye.subinst.length&&angular.isUndefined(ye.role)?e.resultProfiles=[]:(ne(),te())),h.go("inapp.search",ye,{notify:!1,location:"replace"})):"gender"==t&&(1==e.genderCheckboxes[a].checked?(-1==ye.gender.indexOf(a)&&ye.gender.push(a),ne(),te()):(ye.gender.splice(ye.gender.indexOf(a),1),ye.gender.length>0?(ne(),te()):0==ye.designation.length&&0==ye.hometown.length&&0==ye.skill.length&&0==ye.sector.length&&0==ye.degree.length&&0==ye.company.length&&0==ye.city.length&&0==ye.yop.length&&0==ye.department.length&&""==ye.name&&0==ye.subinst.length&&angular.isUndefined(ye.role)?e.resultProfiles=[]:(ne(),te())),h.go("inapp.search",ye,{notify:!1,location:"replace"})),e.queryString=ce(),pe()}function Q(a,t){"company"==t&&(e.companyCheckboxes[a].checked=!1),"designation"==t&&(e.designationCheckboxes[a].checked=!1),"city"==t&&(e.citiesCheckboxes[a].checked=!1),"hometown"==t&&(e.hometownCheckboxes[a].checked=!1),"department"==t&&(e.departmentCheckboxes[a].checked=!1),"degree"==t&&(e.degreeCheckboxes[a].checked=!1),"yop"==t&&(e.yopCheckboxes[a].checked=!1),"subinst"==t&&(e.subInstCheckboxes[a].checked=!1),"role"==t&&(e.optionSelected=0,e.peopleSelected()),"sector"==t&&(e.sectorCheckboxes[a].checked=!1),"skill"==t&&(e.skillCheckboxes[a].checked=!1),"gender"==t&&(e.genderCheckboxes[a].checked=!1),e.boxChanged(a,t,!0)}function X(){Pe=1,be="name";var a=e.pName.basic_info.name;e.displayName=e.pName.basic_info.name,ye.name=a.trim(),ne(),te(),ye.name=a.trim(),h.go("inapp.search",ye,{notify:!1,location:"replace"}),pe()}function Z(a){13===(a.which||a.keyCode)&&e.nameFieldChange()}function ee(a){function t(e){e.close.then(function(){})}e.test={},e.test.pwd="",e.downloadEmptyWarning=!1,e.downloadWarning=!1,e.displayFilters=ce(),e.showDownloadLoading=!1,e.waitingText="",s.showModal({scope:e,templateUrl:"./templates/modals/downloadModal_md.html",controller:"OpenDownloadSearchModalController",target:a.target}).then(t)}function ae(e,a,t,n){function r(e){function n(e){}var r={uui:a},i={id:e.id,probability:e.probability,roleId:t};l.postDataCall("./checkout/life_membership/temp_lm",r,n),l.postDataCall("./admin/updateCollegeTable",i,n)}var i={uid:e,submitText:"Make Life Member",target:n.target};c.getSuggestions(i,r)}function te(a){function n(t){e.isFetching1=!1,e.isFetchingSelected=!1,e.resetting_waiting&&(e.resetting_waiting=!1),1==t.success?(Fe=0,"all"==a?(Ce++,we=we.concat(t.data),e.resultProfiles=we):(Pe++,e.resultProfiles=e.resultProfiles.concat(t.data))):(Fe=1,"all"==a&&(e.seemoreHide=!0)),u.app_data.same_com_log||(Fe=1,e.showLoginCard=e.totalCount.count-e.resultProfiles.length>=10),as_upgrade(100)}var r;void 0!=Oe&&Oe.resolve(),Oe=t.defer(),Fe=1,"all"==a?(r={rnd:xe,stream:Ce},e.isFetching1=!0,1==Ce&&(e.resetting_waiting=!0),r.other_params||(r.other_params={}),r.other_params.fetch_lost=!1):(r=angular.copy(ye),r.stream=Pe,e.isFetchingSelected=!0,1==Pe&&(e.resultProfiles=[],e.resetting_waiting=!0),r.other_params||(r.other_params={}),r.other_params.fetch_lost=!0);var i={timeout:Oe.promise};return u.app_data.same_com_log?l.postDataConfigCall("./search/UserSearch",r,i,n):(r.rnd=0,l.postDataConfigCall("./search/UserSearch",r,i,n))}function ne(){function a(a){e.isFetchingSelected=!1,1==a.success&&(e.resultCount=a.data,me())}var n;void 0!=Te&&Te.resolve(),Te=t.defer(),n=angular.copy(ye),n.other_params||(n.other_params={}),n.other_params.fetch_lost=!0,e.isFetchingSelected=!0;var r={timeout:Te.promise};return l.postDataConfigCall("./search/filterCount",n,r,a)}function re(e,a,t){function n(e){var a;a=1==e.success&&null!=e.data?e:{data:0},t(a)}var r={type:e,id:a};return l.postDataCall("./search/getCount",r,n)}function ie(){te("all")}function oe(){te()}function se(){var a,t,n="";return angular.forEach(ye,function(r,i){if("company"==i&&(a="companyCheckboxes",t="Work at"),"designation"==i&&(a="designationCheckboxes",t="Designated as"),"city"==i&&(a="citiesCheckboxes",t="Live in"),"hometown"==i&&(a="hometownCheckboxes",t="Hometown is"),"department"==i&&(a="departmentCheckboxes",t="Graduated from"),"degree"==i&&(a="degreeCheckboxes",t="Have a degree in"),"yop"==i&&(a="yopCheckboxes",t="Graduated in"),"subinst"==i&&(a="subInstCheckboxes",t="Of Sub Institute"),"sector"==i&&(a="sectorCheckboxes",t="from business domain"),"skill"==i&&(a="skillCheckboxes",t="having skill"),"gender"==i&&(a="genderCheckboxes",t="of gender"),"role"==i&&(ye.role.indexOf("1")>-1||ye.role.indexOf(1)>-1?n+=" Who are Students":ye.role.indexOf("2")>-1||ye.role.indexOf(2)>-1?n+=" Who are Faculty":ye.role.indexOf("3")>-1||ye.role.indexOf(3)>-1?n+=" Who are Alumni":(ye.role.indexOf("4")>-1||ye.role.indexOf(4)>-1)&&(n+=" Who are Admin")),"name"==i&&r&&(n=n+" For `"+r+"`"),0!=r.length&&"name"!=i&&"role"!=i){""!=n&&(n+=" and"),n=n+" "+t,n=n+" "+e[a][r[0]].name;for(var o=1;o<r.length;o++)n=n+" or "+e[a][r[o]].name}}),n}function ce(){var a,t,n=[];return e.checked_category={},angular.forEach(ye,function(r,i){if(null!=r&&""!=r&&(e.checked_category[i]=!0),"company"==i&&(a="companyCheckboxes",t="company"),"designation"==i&&(a="designationCheckboxes",t="designation"),"city"==i&&(a="citiesCheckboxes",t="city"),"hometown"==i&&(a="hometownCheckboxes",t="hometown"),"department"==i&&(a="departmentCheckboxes",t="department"),"degree"==i&&(a="degreeCheckboxes",t="degree"),"yop"==i&&(a="yopCheckboxes",t="yop"),"subinst"==i&&(a="subInstCheckboxes",t="subinst"),"sector"==i&&(a="sectorCheckboxes",t="sector"),"skill"==i&&(a="skillCheckboxes",t="skill"),"gender"==i&&(a="genderCheckboxes",t="gender"),console.log(i),"role"==i&&(ye.role.indexOf("1")>-1||ye.role.indexOf(1)>-1?n.push({key:"role",value:T(1),id:""}):ye.role.indexOf("2")>-1||ye.role.indexOf(2)>-1?n.push({key:"role",value:T(2),id:""}):ye.role.indexOf("3")>-1||ye.role.indexOf(3)>-1?n.push({key:"role",value:T(3),id:""}):(ye.role.indexOf("4")>-1||ye.role.indexOf(4)>-1)&&n.push({key:"role",value:T(4),id:""})),0!=r.length&&"name"!=i&&"role"!=i)for(var o=0;o<r.length;o++)void 0!=e[a][r[o]]&&n.push({key:t,value:e[a][r[o]].name,id:e[a][r[o]].id})}),n}function de(e){return-1==Ae.indexOf(String(e))}function le(e){snackbar_general("Added to "+n("asLingo")("35"),2500),Ae.push(e)}function he(e){return ge!=e}function ue(e,a,t,n){var r={name:e,uui:a,uid:t};i.openSendBox(r,n.target)}function pe(){e.isEmpty=!0,angular.forEach(ye,function(a,t){"string"==typeof a?""!=a&&(e.isEmpty=!1):a.length>0&&(e.isEmpty=!1)}),1==e.isEmpty&&(Pe=1,0==we.length?te("all"):e.resultProfiles=we)}function me(){function a(e){_e++}if(u.app_data.same_com_log&&(new Date).getTime()-Se>8e3){console.log("tracking now");var t={count:e.resultCount[0].count,params:ye,index:_e};return l.postDataCall("./search/track_searches",t,a)}}u.app_data.same_com_log&&f.networkingStatus(0),e.categories_animation=!1,o(function(){e.categories_animation=!0},2e3),e.$state=h;var fe=u.app_data.cid,ge=u.app_data.uid;e.showDrawer=!1;var ye={},_e=0,Se=0,be="top",ve="none";ye.company=[],ye.city=[],ye.department=[],ye.degree=[],ye.yop=[],ye.subinst=[],ye.sector=[],ye.skill=[],ye.gender=[],ye.hometown=[],ye.designation=[];var ke=u.app_data.data.establish_year;e.urlToShare=a.absUrl();var we=[],xe=Math.floor(4*Math.random())+1,Ce=1,Pe=2,Fe=0;e.departments=[],e.sectors=[],e.skills=[],e.degrees=[],e.subInstCheckboxes={};var Ne=4,De=[],Ie={id:fe};e.company_id=-1,e.designation_id=-1,e.location_id=-1,e.hometown_id=-1,e.department_id=-1,e.degree_id=-1,e.yop_id=-1,e.subinst_id=-1;var Le=document.getElementById("countDiv");e.isFetching1=!1;var Oe,Te,qe=[];qe=B(["company","designation","city","hometown","yop","department","degree","subinst","name","role","sector","gender","skill"],qe),e.isEmpty=!0,e.s3_url=s3base;var Ee={},Ae=[],Re=!1,$e={};e.gendersOpt=[{id:1,name:"Male"},{id:2,name:"Female"},{id:3,name:"Other"}],e.toggleDrawer=D,e.peopleSelected=I,e.filterDeptOnChange=$,e.filterDegOnChange=U,e.filterCollegeOnChange=W,e.resetAll=H,e.filterSectOnChange=J,e.filterSkillOnChange=K,e.filterGenderOnChange=Y,e.boxChanged=z,e.crossButton=Q,e.nameFieldChange=X,e.checkIfEnterKeyWasPressed=Z,e.openDownload=ee,e.getSuggestions=ae,e.allLoadMore=ie,e.selectedLoadMore=oe,e.notInNetwork=de,e.updateNetList=le,e.notMe=he,e.messageBtnClick=ue,e.stringBuilder1=se,e.isAllowed=p.isAllowed,e.allow_email=y,e.inviteVia=_,N(!1),function(){var a={queryString:d};e.resetting_waiting=!0;var t=Object.keys(a.queryString).reduce(function(e,a){return"metaTags"!==a&&"pageTitle"!==a||e},!1);console.log("if","addFetchLost:",t),t&&(a.other_params={fetch_lost:!0}),l.postDataConfigCall("./search/index_api",a,{},g)}(),e.$watch("company_id",b,!0),e.$watch("designation_id",v,!0),e.$watch("location_id",k,!0),e.$watch("hometown_id",w,!0),e.$watch("subinst_id",x,!0),e.$watch("department_id",C,!0),e.$watch("degree_id",P,!0),e.$watch("yop_id",F,!0),e.$on("$locationChangeSuccess",S,!0)}function a(e,a,t,n,r,i){function o(){r.post("./changepassword/logged_in_api?redirect=search"),a()}function s(r){function o(t){1==t.success?(e.downloadWarning=!1,e.downloadEmptyWarning=!1,e.showDownloadLoading=!0,n(function(){e.waitingText="Authenticating...",n(function(){e.waitingText="Fetching results....",n(function(){e.waitingText="Downloading...",n(function(){e.showDownloadLoading=!1,a(r);var t=e.stringBuilder1();if(-1===window.location.search.indexOf("?"))var n=window.location.search+"?other_params[fetch_lost]=true";else var n=window.location.search+"&other_params[fetch_lost]=true";i.do(window.API_BASE_URL+"search/download_new/"+encodeURIComponent(t).replace(/\(/g,"%28").replace(/\)/g,"%29")+n,"csv","text/csv")},1e3)},2e3)},2e3)},0)):(e.downloadEmptyWarning=!1,e.downloadWarning=!0)}var s=e.test.pwd;if(""!=s&&null!=s){var c={enteredPass:s};return t.postDataCall("./search/checkPasswordOnDownload",c,o)}e.downloadWarning=!1,e.downloadEmptyWarning=!0}as_upgrade(10),e.close=a,e.okClick=s,e.changePasswordButton=o}angular.module("as.search").controller("SearchController",e).controller("OpenDownloadSearchModalController",a),e.$inject=["$scope","$location","$q","$filter","$window","asMessages","$timeout","ModalService","suggestions","$stateParams","sidetopHttp","$state","$rootScope","adminRights","invitation","asNetwork"],a.$inject=["$scope","close","sidetopHttp","$timeout","$http","fileDownload"]}(),function(){"use strict";function e(e,a,t,n,r,i,o,s,c,d,l,h,u,p,m){function f(e){console.log("setUrlQuery","queryString:",angular.copy(e)),delete e.stream,delete e.other_params,e=Object.keys(e).filter(function(e){return-1==["form","rnd"].indexOf(e)}).reduce(function(a,t){var n=e[t];return(n.constructor!==Array||n.constructor==Array&&n.length>0)&&(a[t]=n),a},{});var a={searchparams:void 0};if(Object.keys(e).length>0)var a={searchparams:JSON.stringify(e)};h.go(".",a,{notify:!1,location:"replace",inherit:!1})}e.startSearchNow={},function(){var a=d.searchparams?JSON.parse(d.searchparams):{};a=Object.keys(d).filter(function(e){return-1==["metaTags","pageTitle","searchparams","form","rnd"].indexOf(e)}).reduce(function(e,t){var n=d[t];return isNullUndefined(n)?e:(a[t]&&delete a[t],e[t]||(e[t]=[]),n.constructor==Array?e[t]=angular.merge(e[t],n):e[t].push(n),e)},a),e.searchInitialData={fetchLost:2,dataParams:Object.keys(a).filter(function(e){return-1==["metaTags","pageTitle"].indexOf(e)}).reduce(function(e,t){return e[t]||void 0===a[t]||(e[t]=[]),void 0!==a[t]&&(a[t].constructor==Array?e[t]=angular.merge(e[t],a[t]):a[t].constructor==Object?e[t]=a[t]:e[t].push(a[t])),e},{}),categories:[{fields:["name"],displayName:"Keyword"},{fields:["life_membership_number","role","subinst","yop","department","degree","city","hometown","company","designation","industry","skill","gender"],displayName:"Filters"}]},angular.isDefined(u.app_data.config.meta[52])&&angular.isObject(u.app_data.config.meta[52].search_init_data)&&angular.merge(e.searchInitialData,u.app_data.config.meta[52].search_init_data),e.reportingFun={fetchingProfiles:function(e){e.dataTosend.directory=!0;var a=angular.copy(e);f(a.dataTosend.queryString?a.dataTosend.queryString:a.dataTosend)}},o(function(){e.startSearchNow.start()},300)}()}angular.module("as.search").controller("SearchControllerV2",e),e.$inject=["$scope","$location","$http","$filter","$window","asMessages","$timeout","ModalService","suggestions","$stateParams","sidetopHttp","$state","$rootScope","adminRights","invitation"]}();
//# sourceMappingURL=search.min.js.map
